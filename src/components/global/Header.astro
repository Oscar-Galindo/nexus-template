---
/**
 * Header Component - Online Nexus Marketing
 * 
 * Fixed header with navigation, logo, and CTA
 */

import Logo from './Logo.astro';
import Navigation from './Navigation';
import Container from '@/components/ui/Container.astro';
import type { Navigation as NavigationType } from '@/lib/contentful';

export interface Props {
  navigation?: NavigationType;
  transparent?: boolean;
}

const {
  navigation,
  transparent = false,
} = Astro.props;

const currentPath = Astro.url.pathname;

// Fallback navigation data
const navLinks = navigation?.navLinks || [
  { label: 'Home', url: '/' },
  { label: 'About', url: '/about' },
  { label: 'Services', url: '/services' },
  { label: 'Pricing', url: '/pricing' },
  { label: 'Contact', url: '/contact' },
];

const ctaText = navigation?.ctaText || 'Get Started';
const ctaUrl = navigation?.ctaUrl || '/contact';
---

<header
  class:list={[
    'fixed top-0 left-0 right-0 z-50 transition-all duration-300',
    transparent ? 'bg-transparent' : 'bg-white/90 backdrop-blur-md shadow-sm'
  ]}
  data-header
>
  <Container>
    <div class="h-20 flex items-center justify-between">
      <!-- Logo -->
      <a href="/" class="flex items-center" aria-label="Home">
        <Logo
          logo={navigation?.logo}
          siteName="Online Nexus"
        />
      </a>

      <!-- Navigation -->
      <Navigation
        client:load
        navLinks={navLinks}
        ctaText={ctaText}
        ctaUrl={ctaUrl}
        currentPath={currentPath}
      />
    </div>
  </Container>
</header>

<!-- Spacer to prevent content from hiding under fixed header -->
<div class="h-20" aria-hidden="true"></div>

<script>
  // Add scroll effect to header
  const header = document.querySelector('[data-header]');
  let lastScroll = 0;

  window.addEventListener('scroll', () => {
    const currentScroll = window.scrollY;

    if (header) {
      // Add shadow when scrolled
      if (currentScroll > 20) {
        header.classList.add('shadow-md');
      } else {
        header.classList.remove('shadow-md');
      }

      // Optional: Hide header on scroll down, show on scroll up
      // if (currentScroll > lastScroll && currentScroll > 100) {
      //   header.style.transform = 'translateY(-100%)';
      // } else {
      //   header.style.transform = 'translateY(0)';
      // }
    }

    lastScroll = currentScroll;
  });
</script>
